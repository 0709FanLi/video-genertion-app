# Sora 2 API è§†é¢‘ç”Ÿæˆæ¥å£è°ƒç”¨æ–‡æ¡£

## ä¸€ã€æ¦‚è¿°

### API åŸºç¡€ä¿¡æ¯
- **API åœ°å€**: `https://api.apiyi.com/v1/chat/completions`
- **è¯·æ±‚æ–¹å¼**: POST
- **è®¤è¯æ–¹å¼**: Bearer Tokenï¼ˆåœ¨ Header ä¸­ä¼ é€’ï¼‰
- **Content-Type**: `application/json`
- **æµå¼è¾“å‡º**: æ”¯æŒæµå¼è¾“å‡ºï¼ˆstream: trueï¼‰

### æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨

| æ¨¡å‹å | æè¿° | åˆ†è¾¨ç‡ | æ—¶é•¿ | ä»·æ ¼ |
|--------|------|--------|------|------|
| sora_video2 | Sora 2 è§†é¢‘ï¼ˆé»˜è®¤ç«–å±ï¼‰ | 704 Ã— 1280 | 10s | $0.15/æ¬¡ |
| sora_video2-landscape | Sora 2 æ¨ªå±è§†é¢‘ | 1280 Ã— 704 | 10s | $0.15/æ¬¡ |
| sora_video2-15s | Sora 2 ç«–å± 15sè§†é¢‘ | 704 Ã— 1280 | 15s | $0.15/æ¬¡ |
| sora_video2-landscape-15s | Sora 2 æ¨ªå± 15sè§†é¢‘ | 1280 Ã— 704 | 15s | $0.15/æ¬¡ |

**æ³¨æ„**: 
- æ¨¡å‹æ ¹æ®æ¨¡å‹ååŒºåˆ†æ¨ªç«–å±å’Œæ—¶é•¿ï¼ˆè€Œä¸æ˜¯å‚æ•°ï¼‰
- ä»·æ ¼é»˜è®¤ä¸º $0.15/æ¬¡ï¼ˆçº¦ 1.05 å…ƒï¼‰
- ç”Ÿæˆæ—¶é—´ï¼š10s è§†é¢‘çº¦ 3 åˆ†é’Ÿå·¦å³ï¼Œ15s è§†é¢‘çº¦ 5 åˆ†é’Ÿå·¦å³
- è§†é¢‘é“¾æ¥ä»…ä¿ç•™ 1 å¤©ï¼Œè¯·åŠæ—¶ä¸‹è½½ä¿å­˜

---

## äºŒã€Python æ¥å£è°ƒç”¨ç¤ºä¾‹

### 2.1 æ–‡ç”Ÿè§†é¢‘ï¼ˆText-to-Videoï¼‰

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Sora 2 æ–‡ç”Ÿè§†é¢‘ API - Python SDK
æ ¹æ®æ–‡å­—æè¿°ç”Ÿæˆè§†é¢‘ï¼Œå®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿›åº¦

ä¾èµ–å®‰è£…: pip install requests

ä½¿ç”¨æ–¹æ³•:
1. è®¾ç½® API_KEY æˆ–ç›´æ¥åœ¨ä»£ç ä¸­å¡«å†™
2. è°ƒç”¨ generate_video() å‡½æ•°
3. è·å–ç”Ÿæˆçš„è§†é¢‘URLé“¾æ¥å¹¶è‡ªè¡Œä¿å­˜ï¼ˆè§†é¢‘ä»…ä¿ç•™1å¤©ï¼‰

ä½œè€…: APIæ˜“
æ–‡æ¡£: https://docs.apiyi.com
"""

import requests
import json
import re
import os


def generate_video(prompt, api_key=None, model="sora_video2"):
    """
    æ–‡ç”Ÿè§†é¢‘ - æ ¹æ®æ–‡å­—æè¿°ç”Ÿæˆè§†é¢‘
    
    å‚æ•°:
        prompt (str): è§†é¢‘ç”Ÿæˆæç¤ºè¯
        api_key (str): APIæ˜“çš„å¯†é’¥ï¼Œå¦‚ä¸æä¾›åˆ™ä»ç¯å¢ƒå˜é‡ API_KEY è¯»å–
        model (str): æ¨¡å‹åç§°ï¼Œå¯é€‰å€¼:
            - sora_video2 (é»˜è®¤ï¼Œç«–å± 704Ã—1280, 10s)
            - sora_video2-landscape (æ¨ªå± 1280Ã—704, 10s)
            - sora_video2-15s (ç«–å± 704Ã—1280, 15s)
            - sora_video2-landscape-15s (æ¨ªå± 1280Ã—704, 15s)
    
    è¿”å›:
        str: è§†é¢‘URLé“¾æ¥ï¼Œå¤±è´¥è¿”å› None
    
    ç¤ºä¾‹:
        >>> video_url = generate_video("A happy cat playing in the garden")
        >>> print(video_url)
    """
    if api_key is None:
        api_key = os.getenv("API_KEY")
    
    if not api_key:
        raise ValueError("è¯·è®¾ç½® API_KEY ç¯å¢ƒå˜é‡æˆ–ä¼ å…¥ api_key å‚æ•°")
    
    url = "https://api.apiyi.com/v1/chat/completions"
    headers = {
        "Authorization": f"Bearer {api_key}",
        "Content-Type": "application/json"
    }
    
    data = {
        "model": model,
        "stream": True,
        "messages": [
            {
                "role": "user",
                "content": [
                    {
                        "type": "text",
                        "text": prompt
                    }
                ]
            }
        ]
    }
    
    print(f"ğŸ¬ å¼€å§‹ç”Ÿæˆè§†é¢‘...")
    print(f"ğŸ“ æç¤ºè¯: {prompt}")
    print(f"ğŸ¯ æ¨¡å‹: {model}\n")
    
    try:
        response = requests.post(url, headers=headers, json=data, stream=True, timeout=600)
        response.raise_for_status()
    except requests.exceptions.RequestException as e:
        print(f"âŒ è¯·æ±‚å¤±è´¥: {e}")
        return None
    
    video_url = None
    error_message = None
    
    # è§£ææµå¼è¾“å‡º
    try:
        for line in response.iter_lines():
            if line:
                line = line.decode('utf-8')
                if line.startswith('data: '):
                    data_str = line[6:]  # ç§»é™¤ 'data: ' å‰ç¼€
                    if data_str == '[DONE]':
                        break
                    
                    try:
                        data_json = json.loads(data_str)
                        content = data_json.get('choices', [{}])[0].get('delta', {}).get('content', '')
                        
                        if content:
                            # æ‰“å°è¿›åº¦ä¿¡æ¯
                            if 'è¿›åº¦' in content or 'é˜Ÿåˆ—' in content or 'æˆåŠŸ' in content:
                                print(content.strip())
                            
                            # æ£€æŸ¥é”™è¯¯ä¿¡æ¯
                            if 'error' in content.lower() or 'å¤±è´¥' in content or 'é”™è¯¯' in content:
                                error_message = content.strip()
                                print(f"âš ï¸ {error_message}")
                            
                            # æå–è§†é¢‘é“¾æ¥
                            if 'è§†é¢‘ç”ŸæˆæˆåŠŸ' in content:
                                # æ­£åˆ™æå– markdown é“¾æ¥ä¸­çš„ URL
                                match = re.search(r'\[ç‚¹å‡»è¿™é‡Œ\]\((https?://[^\)]+)\)', content)
                                if match:
                                    video_url = match.group(1)
                    except json.JSONDecodeError:
                        continue
    
    except requests.exceptions.ChunkedEncodingError as e:
        print(f"\nâš ï¸ è¿æ¥ä¸­æ–­: {str(e)}")
        print("ğŸ’¡ å¯èƒ½åŸå› :")
        print(" 1. å†…å®¹å®¡æ ¸æœªé€šè¿‡ï¼ˆçœŸå®äººè„¸ã€æ•æ„Ÿå†…å®¹ç­‰ï¼‰")
        print(" 2. æœåŠ¡å™¨ç«¯ç”Ÿæˆå¤±è´¥")
        print(" 3. ç½‘ç»œè¿æ¥ä¸ç¨³å®š")
        print("\nå»ºè®®:")
        print(" - ä¿®æ”¹æç¤ºè¯ï¼Œé¿å…çœŸå®äººç‰©ã€æ•æ„Ÿå†…å®¹æè¿°")
        print(" - ç¨åé‡è¯•")
        return None
    
    except Exception as e:
        print(f"\nâŒ å¤„ç†æµå¼è¾“å‡ºæ—¶å‘ç”Ÿé”™è¯¯: {e}")
        return None
    
    if video_url:
        print(f"\nâœ… è§†é¢‘ç”Ÿæˆå®Œæˆï¼")
        print(f"ğŸ”— è§†é¢‘é“¾æ¥: {video_url}")
        print(f"âš ï¸ é‡è¦æç¤º: è§†é¢‘é“¾æ¥ä»…ä¿ç•™ 1 å¤©ï¼Œè¯·ç«‹å³ä¸‹è½½ä¿å­˜åˆ°æœ¬åœ°ï¼")
        return video_url
    else:
        print("\nâŒ æœªèƒ½è·å–è§†é¢‘é“¾æ¥")
        return None


def download_video(video_url, save_path="./sora_video.mp4"):
    """
    ä¸‹è½½è§†é¢‘åˆ°æœ¬åœ°
    
    å‚æ•°:
        video_url (str): è§†é¢‘URLé“¾æ¥
        save_path (str): ä¿å­˜è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•ä¸‹çš„ sora_video.mp4
    
    è¿”å›:
        bool: ä¸‹è½½æˆåŠŸè¿”å› Trueï¼Œå¤±è´¥è¿”å› False
    """
    try:
        print(f"\nğŸ“¥ å¼€å§‹ä¸‹è½½è§†é¢‘...")
        response = requests.get(video_url, stream=True, timeout=60)
        response.raise_for_status()
        
        with open(save_path, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                f.write(chunk)
        
        print(f"âœ… è§†é¢‘å·²ä¿å­˜åˆ°: {save_path}")
        return True
    except Exception as e:
        print(f"âŒ ä¸‹è½½å¤±è´¥: {e}")
        return False


# ==================== ä½¿ç”¨ç¤ºä¾‹ ====================
if __name__ == "__main__":
    # è®¾ç½®ä½ çš„ API Key
    API_KEY = "sk-"  # æ›¿æ¢ä¸ºä½ çš„ apiyi æŒ‰æ¬¡è®¡è´¹çš„å¯†é’¥
    
    print("=" * 60)
    print("Sora 2 æ–‡ç”Ÿè§†é¢‘ç¤ºä¾‹")
    print("=" * 60)
    
    # ç¤ºä¾‹1: åŸºç¡€ä½¿ç”¨ - ç”Ÿæˆç«–å±è§†é¢‘ï¼ˆ10sï¼‰
    prompt = "A happy cat playing with a ball in a sunny garden"
    video_url = generate_video(prompt, api_key=API_KEY, model="sora_video2")
    
    # è‡ªåŠ¨ä¸‹è½½è§†é¢‘åˆ°æœ¬åœ°
    if video_url:
        download_video(video_url, save_path="./cat_playing.mp4")
    
    # ç¤ºä¾‹2: ç”Ÿæˆæ¨ªå±è§†é¢‘ï¼ˆ10sï¼‰
    # prompt2 = "A wide landscape view of mountains and lakes"
    # video_url2 = generate_video(prompt2, api_key=API_KEY, model="sora_video2-landscape")
    # if video_url2:
    #     download_video(video_url2, save_path="./landscape.mp4")
    
    # ç¤ºä¾‹3: ç”Ÿæˆç«–å±è§†é¢‘ï¼ˆ15sï¼‰
    # prompt3 = "A futuristic city at sunset with flying cars"
    # video_url3 = generate_video(prompt3, api_key=API_KEY, model="sora_video2-15s")
    # if video_url3:
    #     download_video(video_url3, save_path="./futuristic_city_15s.mp4")
    
    # ç¤ºä¾‹4: ç”Ÿæˆæ¨ªå±è§†é¢‘ï¼ˆ15sï¼‰
    # prompt4 = "A cinematic scene of ocean waves crashing on a beach"
    # video_url4 = generate_video(prompt4, api_key=API_KEY, model="sora_video2-landscape-15s")
    # if video_url4:
    #     download_video(video_url4, save_path="./ocean_waves_15s.mp4")
```

---

### 2.2 å›¾ç”Ÿè§†é¢‘ï¼ˆImage-to-Videoï¼‰

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Sora 2 å›¾ç”Ÿè§†é¢‘ API - Python SDK
æ ¹æ®å›¾ç‰‡å’Œæ–‡å­—æè¿°ç”Ÿæˆè§†é¢‘ï¼Œå®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿›åº¦

ä¾èµ–å®‰è£…: pip install requests

ä½¿ç”¨æ–¹æ³•:
1. è®¾ç½® API_KEY æˆ–ç›´æ¥åœ¨ä»£ç ä¸­å¡«å†™
2. è°ƒç”¨ generate_video_from_image() å‡½æ•°
3. è·å–ç”Ÿæˆçš„è§†é¢‘URLé“¾æ¥å¹¶è‡ªè¡Œä¿å­˜ï¼ˆè§†é¢‘ä»…ä¿ç•™1å¤©ï¼‰
4. æ”¯æŒæœ¬åœ°å›¾ç‰‡å’Œç½‘ç»œå›¾ç‰‡URL

ä½œè€…: APIæ˜“
æ–‡æ¡£: https://docs.apiyi.com
"""

import requests
import json
import re
import base64
import os


def generate_video_from_image(prompt, image_path_or_url, api_key=None, model="sora_video2"):
    """
    å›¾ç”Ÿè§†é¢‘ - æ ¹æ®å›¾ç‰‡å’Œæ–‡å­—æè¿°ç”Ÿæˆè§†é¢‘
    
    å‚æ•°:
        prompt (str): è§†é¢‘ç”Ÿæˆæç¤ºè¯
        image_path_or_url (str): å›¾ç‰‡è·¯å¾„ï¼ˆæœ¬åœ°æ–‡ä»¶ï¼‰æˆ–URLé“¾æ¥
        api_key (str): APIæ˜“çš„å¯†é’¥ï¼Œå¦‚ä¸æä¾›åˆ™ä»ç¯å¢ƒå˜é‡ API_KEY è¯»å–
        model (str): æ¨¡å‹åç§°ï¼Œå¯é€‰å€¼:
            - sora_video2 (é»˜è®¤ï¼Œç«–å± 704Ã—1280, 10s)
            - sora_video2-landscape (æ¨ªå± 1280Ã—704, 10s)
            - sora_video2-15s (ç«–å± 704Ã—1280, 15s)
            - sora_video2-landscape-15s (æ¨ªå± 1280Ã—704, 15s)
    
    è¿”å›:
        str: è§†é¢‘URLé“¾æ¥ï¼Œå¤±è´¥è¿”å› None
    
    ç¤ºä¾‹:
        >>> # ä½¿ç”¨ç½‘ç»œå›¾ç‰‡
        >>> video_url = generate_video_from_image(
        ...     "Make this scene come alive",
        ...     "https://example.com/image.jpg",
        ...     model="sora_video2-landscape"
        ... )
        >>> # ä½¿ç”¨æœ¬åœ°å›¾ç‰‡
        >>> video_url = generate_video_from_image(
        ...     "Animate this character",
        ...     "./my_image.png"
        ... )
    """
    if api_key is None:
        api_key = os.getenv("API_KEY")
    
    if not api_key:
        raise ValueError("è¯·è®¾ç½® API_KEY ç¯å¢ƒå˜é‡æˆ–ä¼ å…¥ api_key å‚æ•°")
    
    url = "https://api.apiyi.com/v1/chat/completions"
    headers = {
        "Authorization": f"Bearer {api_key}",
        "Content-Type": "application/json"
    }
    
    # åˆ¤æ–­æ˜¯æœ¬åœ°æ–‡ä»¶è¿˜æ˜¯URL
    if image_path_or_url.startswith('http://') or image_path_or_url.startswith('https://'):
        image_url = image_path_or_url
        print(f"ğŸ–¼ï¸ ä½¿ç”¨ç½‘ç»œå›¾ç‰‡: {image_path_or_url}")
    else:
        # æœ¬åœ°æ–‡ä»¶ï¼Œè½¬ä¸º base64
        try:
            with open(image_path_or_url, 'rb') as f:
                image_data = base64.b64encode(f.read()).decode('utf-8')
            
            # æ ¹æ®æ–‡ä»¶æ‰©å±•ååˆ¤æ–­ç±»å‹
            ext = image_path_or_url.lower().split('.')[-1]
            mime_type = f"image/{ext}" if ext in ['png', 'jpg', 'jpeg', 'gif', 'webp'] else "image/jpeg"
            image_url = f"data:{mime_type};base64,{image_data}"
            
            print(f"ğŸ–¼ï¸ ä½¿ç”¨æœ¬åœ°å›¾ç‰‡: {image_path_or_url}")
        except FileNotFoundError:
            print(f"âŒ å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨: {image_path_or_url}")
            return None
        except Exception as e:
            print(f"âŒ è¯»å–å›¾ç‰‡å¤±è´¥: {e}")
            return None
    
    data = {
        "model": model,
        "stream": True,
        "messages": [
            {
                "role": "user",
                "content": [
                    {
                        "type": "text",
                        "text": prompt
                    },
                    {
                        "type": "image_url",
                        "image_url": {
                            "url": image_url
                        }
                    }
                ]
            }
        ]
    }
    
    print(f"ğŸ¬ å¼€å§‹ç”Ÿæˆè§†é¢‘...")
    print(f"ğŸ“ æç¤ºè¯: {prompt}")
    print(f"ğŸ¯ æ¨¡å‹: {model}\n")
    
    try:
        response = requests.post(url, headers=headers, json=data, stream=True, timeout=600)
        response.raise_for_status()
    except requests.exceptions.RequestException as e:
        print(f"âŒ è¯·æ±‚å¤±è´¥: {e}")
        return None
    
    video_url = None
    error_message = None
    
    # è§£ææµå¼è¾“å‡º
    try:
        for line in response.iter_lines():
            if line:
                line = line.decode('utf-8')
                if line.startswith('data: '):
                    data_str = line[6:]
                    if data_str == '[DONE]':
                        break
                    
                    try:
                        data_json = json.loads(data_str)
                        content = data_json.get('choices', [{}])[0].get('delta', {}).get('content', '')
                        
                        if content:
                            # æ‰“å°è¿›åº¦ä¿¡æ¯
                            if 'è¿›åº¦' in content or 'é˜Ÿåˆ—' in content or 'æˆåŠŸ' in content:
                                print(content.strip())
                            
                            # æ£€æŸ¥é”™è¯¯ä¿¡æ¯
                            if 'error' in content.lower() or 'å¤±è´¥' in content or 'é”™è¯¯' in content:
                                error_message = content.strip()
                                print(f"âš ï¸ {error_message}")
                            
                            # æå–è§†é¢‘é“¾æ¥
                            if 'è§†é¢‘ç”ŸæˆæˆåŠŸ' in content:
                                match = re.search(r'\[ç‚¹å‡»è¿™é‡Œ\]\((https?://[^\)]+)\)', content)
                                if match:
                                    video_url = match.group(1)
                    except json.JSONDecodeError:
                        continue
    
    except requests.exceptions.ChunkedEncodingError as e:
        print(f"\nâš ï¸ è¿æ¥ä¸­æ–­: {str(e)}")
        print("ğŸ’¡ å¯èƒ½åŸå› :")
        print(" 1. å†…å®¹å®¡æ ¸æœªé€šè¿‡ï¼ˆçœŸå®äººè„¸ã€æ•æ„Ÿå†…å®¹ç­‰ï¼‰")
        print(" 2. æœåŠ¡å™¨ç«¯ç”Ÿæˆå¤±è´¥")
        print(" 3. ç½‘ç»œè¿æ¥ä¸ç¨³å®š")
        print("\nå»ºè®®:")
        print(" - ä¿®æ”¹æç¤ºè¯ï¼Œé¿å…çœŸå®äººç‰©æè¿°")
        print(" - æ£€æŸ¥å›¾ç‰‡æ˜¯å¦åŒ…å«æ•æ„Ÿå†…å®¹")
        print(" - ç¨åé‡è¯•")
        return None
    
    except Exception as e:
        print(f"\nâŒ å¤„ç†æµå¼è¾“å‡ºæ—¶å‘ç”Ÿé”™è¯¯: {e}")
        return None
    
    if video_url:
        print(f"\nâœ… è§†é¢‘ç”Ÿæˆå®Œæˆï¼")
        print(f"ğŸ”— è§†é¢‘é“¾æ¥: {video_url}")
        print(f"âš ï¸ é‡è¦æç¤º: è§†é¢‘é“¾æ¥ä»…ä¿ç•™ 1 å¤©ï¼Œè¯·ç«‹å³ä¸‹è½½ä¿å­˜åˆ°æœ¬åœ°ï¼")
        return video_url
    else:
        print("\nâŒ æœªèƒ½è·å–è§†é¢‘é“¾æ¥")
        return None


def download_video(video_url, save_path="./sora_video.mp4"):
    """
    ä¸‹è½½è§†é¢‘åˆ°æœ¬åœ°
    
    å‚æ•°:
        video_url (str): è§†é¢‘URLé“¾æ¥
        save_path (str): ä¿å­˜è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•ä¸‹çš„ sora_video.mp4
    
    è¿”å›:
        bool: ä¸‹è½½æˆåŠŸè¿”å› Trueï¼Œå¤±è´¥è¿”å› False
    """
    try:
        print(f"\nğŸ“¥ å¼€å§‹ä¸‹è½½è§†é¢‘...")
        response = requests.get(video_url, stream=True, timeout=60)
        response.raise_for_status()
        
        with open(save_path, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                f.write(chunk)
        
        print(f"âœ… è§†é¢‘å·²ä¿å­˜åˆ°: {save_path}")
        return True
    except Exception as e:
        print(f"âŒ ä¸‹è½½å¤±è´¥: {e}")
        return False


# ==================== ä½¿ç”¨ç¤ºä¾‹ ====================
if __name__ == "__main__":
    # è®¾ç½®ä½ çš„ API Key
    API_KEY = "sk-"  # æ›¿æ¢ä¸ºä½ çš„å¯†é’¥
    
    print("=" * 60)
    print("Sora 2 å›¾ç”Ÿè§†é¢‘ç¤ºä¾‹")
    print("=" * 60)
    
    # ç¤ºä¾‹1: ä½¿ç”¨æœ¬åœ°å›¾ç‰‡ + ç«–å±æ¨¡å‹ï¼ˆ10sï¼‰
    local_image = "./cat.png"  # æ›¿æ¢ä¸ºå®é™…å›¾ç‰‡è·¯å¾„
    prompt1 = "è¿™åªå¯çˆ±çš„åŠ¨ç‰©åœ¨æ¸¸ä¹åœºæ¬¢å¿«åœ°ç©è€"
    video_url1 = generate_video_from_image(prompt1, local_image, api_key=API_KEY, model="sora_video2")
    if video_url1:
        download_video(video_url1, save_path="./cat_playground.mp4")
    
    # ç¤ºä¾‹2: ä½¿ç”¨ç½‘ç»œå›¾ç‰‡ + æ¨ªå±æ¨¡å‹ï¼ˆ10sï¼‰
    # image_url = "https://example.com/your-image.jpg"  # æ›¿æ¢ä¸ºå®é™…å›¾ç‰‡URL
    # prompt2 = "Make this scene come alive with animation"
    # video_url2 = generate_video_from_image(prompt2, image_url, api_key=API_KEY, model="sora_video2-landscape")
    # if video_url2:
    #     download_video(video_url2, save_path="./animated_scene.mp4")
    
    # ç¤ºä¾‹3: ä½¿ç”¨æœ¬åœ°å›¾ç‰‡ + ç«–å±æ¨¡å‹ï¼ˆ15sï¼‰
    # prompt3 = "Bring this artwork to life"
    # video_url3 = generate_video_from_image(
    #     prompt3,
    #     "./artwork.jpg",
    #     api_key=API_KEY,
    #     model="sora_video2-15s"
    # )
    # if video_url3:
    #     download_video(video_url3, save_path="./artwork_15s.mp4")
    
    # ç¤ºä¾‹4: ä½¿ç”¨æœ¬åœ°å›¾ç‰‡ + æ¨ªå±æ¨¡å‹ï¼ˆ15sï¼‰
    # prompt4 = "A cinematic scene of this landscape"
    # video_url4 = generate_video_from_image(
    #     prompt4,
    #     "./landscape.jpg",
    #     api_key=API_KEY,
    #     model="sora_video2-landscape-15s"
    # )
    # if video_url4:
    #     download_video(video_url4, save_path="./landscape_15s.mp4")
```

---

## ä¸‰ã€è¯·æ±‚æ ¼å¼è¯´æ˜

### 3.1 æ–‡ç”Ÿè§†é¢‘è¯·æ±‚æ ¼å¼

```json
{
  "model": "sora_video2",
  "stream": true,
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "ä½ çš„æç¤ºè¯"
        }
      ]
    }
  ]
}
```

### 3.2 å›¾ç”Ÿè§†é¢‘è¯·æ±‚æ ¼å¼

```json
{
  "model": "sora_video2",
  "stream": true,
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "ä½ çš„æç¤ºè¯"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "å›¾ç‰‡urlæˆ–è€…base64"
          }
        }
      ]
    }
  ]
}
```

**æ³¨æ„**: Base64 çš„æ•´ä¸ªå†…å®¹ï¼Œç›´æ¥æ”¾åˆ° `url` å‚æ•°é‡Œï¼Œæ ¼å¼ä¸º: `data:image/{type};base64,{base64_data}`

---

## å››ã€å“åº”æ ¼å¼

### 4.1 æµå¼è¾“å‡ºæ ¼å¼

å“åº”é‡‡ç”¨ Server-Sent Events (SSE) æ ¼å¼ï¼Œæ¯è¡Œä»¥ `data: ` å¼€å¤´:

```
data: {"choices":[{"delta":{"content":"è§†é¢‘ç”Ÿæˆä¸­..."}}]}
data: {"choices":[{"delta":{"content":"è¿›åº¦: 50%"}}]}
data: {"choices":[{"delta":{"content":"è§†é¢‘ç”ŸæˆæˆåŠŸï¼[ç‚¹å‡»è¿™é‡Œ](https://example.com/video.mp4)"}}]}
data: [DONE]
```

### 4.2 è§†é¢‘é“¾æ¥æå–

è§†é¢‘é“¾æ¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ä»å“åº”å†…å®¹ä¸­æå–:
```python
match = re.search(r'\[ç‚¹å‡»è¿™é‡Œ\]\((https?://[^\)]+)\)', content)
if match:
    video_url = match.group(1)
```

---

## äº”ã€æ³¨æ„äº‹é¡¹

1. **API Key**: éœ€è¦æ›¿æ¢ä¸ºä½ çš„å®é™… API Key
2. **è¶…æ—¶è®¾ç½®**: å»ºè®®è®¾ç½®è¾ƒé•¿çš„è¶…æ—¶æ—¶é—´ï¼ˆ600ç§’ï¼‰ï¼Œå› ä¸ºè§†é¢‘ç”Ÿæˆéœ€è¦æ—¶é—´
3. **é”™è¯¯å¤„ç†**: éœ€è¦å¤„ç†æµå¼è¾“å‡ºä¸­çš„é”™è¯¯ä¿¡æ¯
4. **è§†é¢‘å­˜å‚¨**: ç”Ÿæˆçš„è§†é¢‘é“¾æ¥ä»…ä¿ç•™ 1 å¤©ï¼Œè¯·åŠæ—¶ä¸‹è½½ä¿å­˜
5. **å†…å®¹å®¡æ ¸**: é¿å…çœŸå®äººç‰©ã€æ•æ„Ÿå†…å®¹æè¿°ï¼Œå¦åˆ™å¯èƒ½ç”Ÿæˆå¤±è´¥
6. **å›¾ç‰‡æ ¼å¼**: æ”¯æŒ URL å’Œ Base64 ä¸¤ç§æ–¹å¼ä¸Šä¼ å›¾ç‰‡ï¼ŒBase64 æ—¶éœ€åŒ…å«å®Œæ•´çš„ data URI æ ¼å¼
7. **æ¨¡å‹é€‰æ‹©**: æ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼ˆæ¨ªå±/ç«–å±ï¼Œ10s/15sï¼‰
8. **çœŸäººå‡ºé•œ**: åœ¨æç¤ºè¯ä¸­ä½¿ç”¨ `@sama` æˆ–å…¶ä»–å·²è®¤è¯äººè„¸ Cameo çš„ç”¨æˆ· ID å¯ä»¥è®©çœŸäººå‡ºé•œ

---

## å…­ã€å¸¸è§é—®é¢˜

1. **å¦‚ä½•æ§åˆ¶è§†é¢‘çš„å®½å±è¿˜æ˜¯ç«–å±ï¼Ÿ**
   - é€šè¿‡é€‰æ‹©ä¸åŒçš„æ¨¡å‹åæ¥æ§åˆ¶ï¼š
     - `sora_video2` æˆ– `sora_video2-15s` â†’ ç«–å±
     - `sora_video2-landscape` æˆ– `sora_video2-landscape-15s` â†’ æ¨ªå±

2. **å¦‚ä½•æ§åˆ¶è§†é¢‘æ—¶é•¿ï¼Ÿ**
   - é€šè¿‡é€‰æ‹©ä¸åŒçš„æ¨¡å‹åæ¥æ§åˆ¶ï¼š
     - `sora_video2` æˆ– `sora_video2-landscape` â†’ 10ç§’
     - `sora_video2-15s` æˆ– `sora_video2-landscape-15s` â†’ 15ç§’

3. **å¦‚ä½•å»é™¤æ°´å°ï¼Ÿ**
   - é»˜è®¤ç”Ÿæˆçš„è§†é¢‘æ˜¯æ— æ°´å°çš„

4. **ä¸ºä»€ä¹ˆç”Ÿæˆäººç‰©çš„è§†é¢‘å¤±è´¥ï¼Ÿ**
   - å¯èƒ½æ˜¯å†…å®¹å®¡æ ¸æœªé€šè¿‡ï¼Œå»ºè®®é¿å…çœŸå®äººç‰©æè¿°ï¼Œæˆ–ä½¿ç”¨ `@sama` ç­‰å·²è®¤è¯ID

5. **æ”¯æŒé«˜å¹¶å‘å—ï¼Ÿ**
   - å»ºè®®å¹¶å‘æ•°æ§åˆ¶åœ¨ 30 ä»¥å†…ï¼Œå¤§é‡å¹¶å‘å¯ä»¥è”ç³»æœåŠ¡å•†é¢å¤–ä¿éšœ

6. **è§†é¢‘å­˜å‚¨æ—¶é—´ï¼Ÿ**
   - è§†é¢‘é“¾æ¥ä»…ä¿ç•™ 1 å¤©ï¼Œè¯·åŠæ—¶ä¸‹è½½ä¿å­˜åˆ°æœ¬åœ°

---

## ä¸ƒã€å‚è€ƒé“¾æ¥

- API æ–‡æ¡£: https://docs.apiyi.com
- æ–‡æ¡£æ¥æº: https://xinqikeji.feishu.cn/wiki/RuHDw0BICiRYdokDYy6cPAwunuf
