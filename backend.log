INFO:     Started server process [75594]
INFO:     Waiting for application startup.
2025-10-29 22:35:58,509 - app.main - INFO - AI视频创作工作流系统 v1.0.0 启动中...
2025-10-29 22:35:58,509 - app.main - INFO - 调试模式: False
✅ 数据库表创建成功
2025-10-29 22:35:58,510 - app.main - INFO - 数据库初始化成功
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-10-29 22:35:59,243 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:60894 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:35:59,247 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:60894 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
INFO:     127.0.0.1:60900 - "GET /health HTTP/1.1" 200 OK
2025-10-29 22:39:22,172 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:39:22,176 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:39:22,191 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:39:22,191 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:39:22,191 - app.api.deps_auth - INFO - 认证成功: username=li12345
INFO:     127.0.0.1:61867 - "POST /api/auth/logout HTTP/1.1" 200 OK
INFO:     127.0.0.1:61867 - "OPTIONS /api/auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:61867 - "POST /api/auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:61867 - "OPTIONS /api/auth/me HTTP/1.1" 200 OK
2025-10-29 22:39:23,869 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:39:23,869 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:39:23,870 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:39:23,870 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:39:23,870 - app.api.deps_auth - INFO - 认证成功: username=li12345
INFO:     127.0.0.1:61874 - "GET /api/auth/me HTTP/1.1" 200 OK
2025-10-29 22:39:23,929 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:61874 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:39:23,930 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:61874 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
INFO:     127.0.0.1:61952 - "OPTIONS /api/text-to-image/optimize-prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:61952 - "POST /api/text-to-image/optimize-prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:61954 - "POST /api/text-to-image/optimize-prompt HTTP/1.1" 403 Forbidden
2025-10-29 22:42:35,143 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:62790 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:43:00,803 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:62910 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:43:00,806 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:62910 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
INFO:     127.0.0.1:62910 - "OPTIONS /api/auth/logout HTTP/1.1" 200 OK
2025-10-29 22:43:02,526 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:43:02,527 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:43:02,533 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:43:02,533 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:43:02,533 - app.api.deps_auth - INFO - 认证成功: username=li12345
INFO:     127.0.0.1:62910 - "POST /api/auth/logout HTTP/1.1" 200 OK
INFO:     127.0.0.1:62910 - "POST /api/auth/login HTTP/1.1" 200 OK
2025-10-29 22:43:06,208 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:43:06,208 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:43:06,209 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:43:06,209 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:43:06,209 - app.api.deps_auth - INFO - 认证成功: username=li12345
INFO:     127.0.0.1:62910 - "GET /api/auth/me HTTP/1.1" 200 OK
2025-10-29 22:43:06,255 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:62910 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:43:06,256 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:62910 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
INFO:     127.0.0.1:63227 - "POST /api/text-to-image/optimize-prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:63590 - "OPTIONS /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:45:20,138 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:63590 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:45:43,282 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:63592 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:45:43,282 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:63592 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:45:44,835 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:45:44,836 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:45:44,837 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:45:44,838 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:45:44,838 - app.api.deps_auth - INFO - 认证成功: username=li12345
INFO:     127.0.0.1:63592 - "POST /api/auth/logout HTTP/1.1" 200 OK
INFO:     127.0.0.1:63592 - "POST /api/auth/login HTTP/1.1" 200 OK
2025-10-29 22:45:46,589 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:45:46,589 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:45:46,589 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:45:46,589 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:45:46,589 - app.api.deps_auth - INFO - 认证成功: username=li12345
INFO:     127.0.0.1:63592 - "GET /api/auth/me HTTP/1.1" 200 OK
2025-10-29 22:45:46,634 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:63592 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:45:46,635 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:63592 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
INFO:     127.0.0.1:63765 - "OPTIONS /api/text-to-image/optimize-prompt HTTP/1.1" 200 OK
2025-10-29 22:45:55,497 - app.api.deps_auth - INFO - 收到Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJsa...
2025-10-29 22:45:55,497 - app.api.deps_auth - INFO - Token解码结果: username='li12345' user_id=2
2025-10-29 22:45:55,498 - app.api.deps_auth - INFO - 查询用户: user_id=2, found=True
2025-10-29 22:45:55,499 - app.api.deps_auth - INFO - 用户状态: is_active=True
2025-10-29 22:45:55,499 - app.api.deps_auth - INFO - 认证成功: username=li12345
2025-10-29 22:45:55,501 - app.api.routes.text_to_image - INFO - 收到提示词优化请求: model=qwen-plus, prompt=小猫在小狗旁边...
2025-10-29 22:45:55,501 - LLMService - INFO - 生成图片提示词，用户想法: 小猫在小狗旁边
2025-10-29 22:45:55,502 - LLMService - INFO - 调用通义千问API
2025-10-29 22:46:08,145 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-29 22:46:08,162 - LLMService - INFO - 通义千问API调用成功
2025-10-29 22:46:08,162 - LLMService - INFO - 成功生成3个图片提示词
2025-10-29 22:46:08,162 - app.api.routes.text_to_image - INFO - 提示词优化成功: 一只毛茸茸的白色小猫蜷缩在棕色斑点小狗的身旁，背景是一片阳光洒落的春日花园，嫩绿的草地泛着光，花瓣随风飘落。柔和的自然光从左侧斜照，勾勒出它们温暖的轮廓，画面采用温馨治愈的日系插画风格，构图采用中心对...
2025-10-29 22:46:08,168 - app.services.library_service - INFO - 保存提示词历史: user_id=2, model=qwen-plus, scene=text_to_image
INFO:     127.0.0.1:63765 - "POST /api/text-to-image/optimize-prompt HTTP/1.1" 200 OK
2025-10-29 22:47:27,142 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:64212 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:48:38,144 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:64551 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
2025-10-29 22:48:42,129 - app.api.routes.text_to_image - INFO - 获取模型列表
INFO:     127.0.0.1:64551 - "GET /api/text-to-image/models HTTP/1.1" 200 OK
